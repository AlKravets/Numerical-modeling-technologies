# Лабораторная работа
# Использование метода дискретных особенностей для моделирования аэродинамических процессов + Поле давления

## Вступление

Теоретическая часть описана в [отчете](/report/report.pdf).

## Использование программы

Основными инструментом является функция `main` из [*main.py*](main.py).

Для того, чтобы подстроить ее под себя нужно изменить локальные параметры внутри тела функции:

- `count_updates` -- количество шагов по времени.
- `x_lim`, `y_lim`, `xsteps`, `ysteps` -- границы по координатам пространства и количество точек на сетке (поле скорости и поле давления)
- `V_inf` -- скорость течения, она должна быть комплексным числом по модулю быть равной 1 (желательно, но не обязательно)
- `M` -- количество точек дискретных особенностей. Желательно, чтобы их количество было порядка 20. Это важный параметр от которого зависит условие непроницаемости границы и еще много вещей. Результат может отличатся в зависимости от этого параметра.
- `bar` -- объект границы. О нем ниже.
- `eng` -- объект класса `Engine`. О нем ниже

Далее вызывается функция `plot_barrier_velocity_pressure_at_moment`. Она рисует нужный график. При ее вызове перечислены наиболее интересные параметры. Отдельно остановлюсь на параметре `cmap` -- это цветовая гамма для поля давления, по умолчанию, она центрируется так, чтобы центром гаммы был 0, а края -- это максимальное по модулю значение поля давления. Другие цветовые гаммы можно найти [тут](https://matplotlib.org/stable/tutorials/colors/colormaps.html) (лучше выбирать *diverging colormaps*)


### Класс границы

Класс границы задан в [файле](/barrier.py). Класс любой границы должен быть наследником класса `ABC_Barrier`, в нем указаны абстрактные методы, которые должны быть реализованы в классе границы.


Если у вас граница -- это просто некоторая незамкнутая ломаная, то можно использовать класс `LinearyPiecewiseBarrier`.

Для создания объекта этого класса нужно подать `M`-- количество точек дискретных особенностей и массив с угловыми точками, стоит учесть, что потом именно из этих точек будут выходить вихри.

В лабораторной в файле main.py. Приведены примеры массивов для создания границ

```
#
x0, y0 = 0, 0 

# plate
dots_plate = np.array([[x0, x0], [y0 + 0.5, y0 - 0.5]])
# 2
dots_2 = np.array([[x0, x0 -.25, x0 -.25, x0, x0, x0-.25],
            [y0, y0, y0 + .25, y0+.25 , y0+ .5 , y0+.5]])
# 3
dots_3 = np.array([[x0, x0+.25, x0, x0+0.25, x0],
            [y0, y0+ .25, y0 + .5 , y0+ .75, y0 + 1]])
# 5
dots_5 = np.array([[x0, x0+0.5, x0+0.5, x0, x0, x0+0.5],
                [y0, y0, y0+0.5, y0+0.5, y0+0.75, y0+0.75]])
```

как видите, сначала идет список координат вершин по x, а потом  по y.

![barrier 2 form](/pictures/ex_2_barrier.png)



#### Свой класс границы

Если вам не подходит такой вариант границы, то можно создать свой класс. Примером может быть класс `U_FormBarrier`. Важно, чтобы методы класса возвращали numpy массив комплексных чисел.


### Класс *Engine*

Конструктор класса *Engine* принимает объект класса границы, скорость течения и параметр `delta`, этот параметр отвечает за размер шага по времени. По умолчанию стоит довольно неплохой параметр.

Публичные методы класса:
- `update()` -- шаг по времени
- `V_t(z)` -- возвращает векторное поле скорости в данный момент времени и в данных точках. `z` -- это numpy массив комплексных чисел
- `C_t(z)` -- возвращает поле давления в данный момент времени и в данных точках. `z` -- это numpy массив комплексных чисел.

